<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2 Figure 2 | scAML Project</title>
  <meta name="description" content="2 Figure 2 | scAML Project" />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="2 Figure 2 | scAML Project" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2 Figure 2 | scAML Project" />
  
  
  

<meta name="author" content="Niu Qiao" />


<meta name="date" content="2024-10-30" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="figure-3.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">scAML Booklet</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Figure 1</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#b-umap-distribution-across-aml"><i class="fa fa-check"></i><b>1.1</b> (b) UMAP distribution across AML</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#c-dotplot-of-marker-genes"><i class="fa fa-check"></i><b>1.2</b> (c) Dotplot of marker genes</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#d-bar-charts"><i class="fa fa-check"></i><b>1.3</b> (d) Bar charts</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#e-distribution-of-fusion-positive-cells"><i class="fa fa-check"></i><b>1.4</b> (e) Distribution of fusion positive cells</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#f-scatter-plots"><i class="fa fa-check"></i><b>1.5</b> (f) Scatter plots</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="figure-2.html"><a href="figure-2.html"><i class="fa fa-check"></i><b>2</b> Figure 2</a>
<ul>
<li class="chapter" data-level="2.1" data-path="figure-2.html"><a href="figure-2.html#b-umap-of-hc"><i class="fa fa-check"></i><b>2.1</b> (b) UMAP of HC</a></li>
<li class="chapter" data-level="2.2" data-path="figure-2.html"><a href="figure-2.html#c-umap-distribution-across-aml"><i class="fa fa-check"></i><b>2.2</b> (c) UMAP distribution across AML</a></li>
<li class="chapter" data-level="2.3" data-path="figure-2.html"><a href="figure-2.html#d-bar-charts-1"><i class="fa fa-check"></i><b>2.3</b> (d) Bar charts</a></li>
<li class="chapter" data-level="2.4" data-path="figure-2.html"><a href="figure-2.html#e-fusion-distribution"><i class="fa fa-check"></i><b>2.4</b> (e) Fusion distribution</a></li>
<li class="chapter" data-level="2.5" data-path="figure-2.html"><a href="figure-2.html#f-pseudotime-umap"><i class="fa fa-check"></i><b>2.5</b> (f) Pseudotime UMAP</a></li>
<li class="chapter" data-level="2.6" data-path="figure-2.html"><a href="figure-2.html#g-ridge-plot-of-pseudotime"><i class="fa fa-check"></i><b>2.6</b> (g) Ridge plot of pseudotime</a></li>
<li class="chapter" data-level="2.7" data-path="figure-2.html"><a href="figure-2.html#h-dot-plots-of-signature-scores"><i class="fa fa-check"></i><b>2.7</b> (h) Dot plots of signature scores</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="figure-3.html"><a href="figure-3.html"><i class="fa fa-check"></i><b>3</b> Figure 3</a>
<ul>
<li class="chapter" data-level="3.1" data-path="figure-3.html"><a href="figure-3.html#b-umap-distribution"><i class="fa fa-check"></i><b>3.1</b> (b) UMAP distribution</a></li>
<li class="chapter" data-level="3.2" data-path="figure-3.html"><a href="figure-3.html#c-fusion-distribution"><i class="fa fa-check"></i><b>3.2</b> (c) Fusion distribution</a></li>
<li class="chapter" data-level="3.3" data-path="figure-3.html"><a href="figure-3.html#d-bar-charts-2"><i class="fa fa-check"></i><b>3.3</b> (d) Bar charts</a></li>
<li class="chapter" data-level="3.4" data-path="figure-3.html"><a href="figure-3.html#e-dot-plots-of-signature-scores"><i class="fa fa-check"></i><b>3.4</b> (e) Dot plots of signature scores</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="figure-4.html"><a href="figure-4.html"><i class="fa fa-check"></i><b>4</b> Figure 4</a>
<ul>
<li class="chapter" data-level="4.1" data-path="figure-4.html"><a href="figure-4.html#b-heatmap-of-primitive-cell-types"><i class="fa fa-check"></i><b>4.1</b> (b) Heatmap of primitive cell types</a></li>
<li class="chapter" data-level="4.2" data-path="figure-4.html"><a href="figure-4.html#c-heatmap-of-mature-like-cell-types"><i class="fa fa-check"></i><b>4.2</b> (c) Heatmap of mature-like cell types</a></li>
<li class="chapter" data-level="4.3" data-path="figure-4.html"><a href="figure-4.html#d-distribution-of-fusion-positive-cells"><i class="fa fa-check"></i><b>4.3</b> (d) Distribution of fusion positive cells</a></li>
<li class="chapter" data-level="4.4" data-path="figure-4.html"><a href="figure-4.html#e-scatter-plot-of-correlation"><i class="fa fa-check"></i><b>4.4</b> (e) Scatter plot of correlation</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="figure-5.html"><a href="figure-5.html"><i class="fa fa-check"></i><b>5</b> Figure 5</a>
<ul>
<li class="chapter" data-level="5.1" data-path="figure-5.html"><a href="figure-5.html#a-bar-charts"><i class="fa fa-check"></i><b>5.1</b> (a) Bar charts</a></li>
<li class="chapter" data-level="5.2" data-path="figure-5.html"><a href="figure-5.html#b-dot-plots-of-gsea-results"><i class="fa fa-check"></i><b>5.2</b> (b) Dot plots of GSEA results</a></li>
<li class="chapter" data-level="5.3" data-path="figure-5.html"><a href="figure-5.html#c-e-gsea-plots-across-aml"><i class="fa fa-check"></i><b>5.3</b> (c-e) GSEA plots across AML</a></li>
<li class="chapter" data-level="5.4" data-path="figure-5.html"><a href="figure-5.html#g-dot-plot-in-tnk-cells"><i class="fa fa-check"></i><b>5.4</b> (g) Dot plot in T/NK cells</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="figure-6.html"><a href="figure-6.html"><i class="fa fa-check"></i><b>6</b> Figure 6</a>
<ul>
<li class="chapter" data-level="6.1" data-path="figure-6.html"><a href="figure-6.html#circle-plots"><i class="fa fa-check"></i><b>6.1</b> Circle plots</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="figure-7.html"><a href="figure-7.html"><i class="fa fa-check"></i><b>7</b> Figure 7</a>
<ul>
<li class="chapter" data-level="7.1" data-path="figure-7.html"><a href="figure-7.html#b-umap-by-samples"><i class="fa fa-check"></i><b>7.1</b> (b) UMAP by samples</a></li>
<li class="chapter" data-level="7.2" data-path="figure-7.html"><a href="figure-7.html#c-d-umap-by-annol1-annol2"><i class="fa fa-check"></i><b>7.2</b> (c-d) UMAP by annoL1 &amp; annoL2</a></li>
<li class="chapter" data-level="7.3" data-path="figure-7.html"><a href="figure-7.html#e-alluvial-diagram-of-relapse-group"><i class="fa fa-check"></i><b>7.3</b> (e) Alluvial diagram of relapse group</a></li>
<li class="chapter" data-level="7.4" data-path="figure-7.html"><a href="figure-7.html#f-alluvial-diagram-of-lcr-group"><i class="fa fa-check"></i><b>7.4</b> (f) Alluvial diagram of LCR group</a></li>
<li class="chapter" data-level="7.5" data-path="figure-7.html"><a href="figure-7.html#g-h-umap-by-stage"><i class="fa fa-check"></i><b>7.5</b> (g-h) UMAP by stage</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">scAML Project</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="figure-2" class="section level1 hasAnchor" number="2">
<h1><span class="header-section-number">2</span> Figure 2<a href="figure-2.html#figure-2" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><img src="ref/Figure2.jpg" width="100%" style="display: block; margin: auto;" />
<strong>Fig.2 | Differentiation hierarchies of leukemic blasts across different AML subtypes.</strong></p>
<p><strong>a</strong>, Illustration of merged analysis of immature-like cells in AML BM samples, utilizing 6 publicly available FACS-sorted CD34+ BMMCs as healthy controls (HC).</br>
<strong>b</strong>, UMAP visualization of public CD34+ HC cells, with colors indicating Azimuth level 2 annotations of hematopoietic cell types. The total number of sequenced cells is indicated in the bottom-left corner.</br>
<strong>c</strong>, UMAP facet visualizations of immature-like cell types from t(8;21, t(15;17), and inv(16) AML BMs, with colors indicating semi-supervised leukemia cell type annotation level 2 (annoL2). Grey indicates healthy CD34+ HC cells. The total number of sequenced cells for each AML subtype is indicated in the bottom-left corner.</br>
<strong>d</strong>, Bar charts depicting the relative fractions of 11 annotated cell types (annoL2) in different AML subtypes and HC groups. The left panel shows the average fractions for each AML subtype and the HC group, while the other panels present the fractions for individual samples.</br>
<strong>e</strong>, UMAP visualization showing the distribution of fusion transcripts: RUNX1::RUNX1T1 (red), PML::RARA (green), and CBFB::MYH11 (blue). Grey indicates the cells wherein no fusion transcripts were detected. </br>
<strong>f</strong>, UMAP visualization of monocle3-pseudotime scores. </br>
<strong>g</strong>, Distribution of 11 different cell types along the pseudotime score axis.</br>
<strong>h</strong>, Dot plots of signature scores for gene sets characterizing relevant biological processes across 11 different hematopoietic cell types in AML subtypes and HC groups.</br></p>
<div id="b-umap-of-hc" class="section level2 hasAnchor" number="2.1">
<h2><span class="header-section-number">2.1</span> (b) UMAP of HC<a href="figure-2.html#b-umap-of-hc" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="figure-2.html#cb7-1" tabindex="-1"></a>scAML.prog.anno <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="fu">paste0</span>(in_dir, <span class="st">&quot;Table1.3.scAML.prog_harmony.anno.rds&quot;</span>))</span>
<span id="cb7-2"><a href="figure-2.html#cb7-2" tabindex="-1"></a></span>
<span id="cb7-3"><a href="figure-2.html#cb7-3" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">DimPlot</span>(scAML.prog.anno, <span class="at">reduction =</span> <span class="st">&quot;umap&quot;</span>, <span class="at">group.by =</span> <span class="st">&quot;predicted.celltype.l2&quot;</span>, <span class="at">split.by =</span> <span class="st">&quot;FAB&quot;</span>, </span>
<span id="cb7-4"><a href="figure-2.html#cb7-4" tabindex="-1"></a>    <span class="at">pt.size =</span> <span class="dv">1</span>, <span class="at">label =</span> F, <span class="at">repel =</span> T, <span class="at">raster =</span> T, <span class="at">cols =</span> pcol_2)</span>
<span id="cb7-5"><a href="figure-2.html#cb7-5" tabindex="-1"></a></span>
<span id="cb7-6"><a href="figure-2.html#cb7-6" tabindex="-1"></a><span class="fu">pdf</span>(<span class="fu">paste0</span>(out_dir, <span class="st">&quot;Fig2b.pdf&quot;</span>), <span class="at">width =</span> <span class="dv">20</span>, <span class="at">height =</span> <span class="dv">9</span>)</span>
<span id="cb7-7"><a href="figure-2.html#cb7-7" tabindex="-1"></a>p1 <span class="sc">+</span> p2</span>
<span id="cb7-8"><a href="figure-2.html#cb7-8" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
</div>
<div id="c-umap-distribution-across-aml" class="section level2 hasAnchor" number="2.2">
<h2><span class="header-section-number">2.2</span> (c) UMAP distribution across AML<a href="figure-2.html#c-umap-distribution-across-aml" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="figure-2.html#cb8-1" tabindex="-1"></a>anno_color <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;#E31A1C&quot;</span>, <span class="st">&quot;#86C2E2&quot;</span>, <span class="st">&quot;#33A02C&quot;</span>, <span class="st">&quot;#1F78B4&quot;</span>, <span class="st">&quot;#A65628&quot;</span>, <span class="st">&quot;#B2DF8A&quot;</span>, <span class="st">&quot;#7570B3&quot;</span>, <span class="st">&quot;#73C8B4&quot;</span>, <span class="st">&quot;#F1B6DA&quot;</span>, <span class="st">&quot;#FB8072&quot;</span>, <span class="st">&quot;#D95F02&quot;</span>)</span>
<span id="cb8-2"><a href="figure-2.html#cb8-2" tabindex="-1"></a>anno_name <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;HSC.MPP-like&quot;</span>, <span class="st">&quot;LMPP-like&quot;</span>, <span class="st">&quot;CLP-like&quot;</span>, <span class="st">&quot;GMP-like&quot;</span>, <span class="st">&quot;BaEoMa-like&quot;</span>, <span class="st">&quot;Progs-Prolif&quot;</span>, <span class="st">&quot;NPW-high&quot;</span>, <span class="st">&quot;LSC17-high&quot;</span>, <span class="st">&quot;Pre-DC&quot;</span>, <span class="st">&quot;Erythroid&quot;</span>, <span class="st">&quot;Pre-B&quot;</span>)</span>
<span id="cb8-3"><a href="figure-2.html#cb8-3" tabindex="-1"></a></span>
<span id="cb8-4"><a href="figure-2.html#cb8-4" tabindex="-1"></a></span>
<span id="cb8-5"><a href="figure-2.html#cb8-5" tabindex="-1"></a>anno_color2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;HC_CD34&quot;</span> <span class="ot">=</span> <span class="st">&quot;#D9D9D9&quot;</span>, anno_color)</span>
<span id="cb8-6"><a href="figure-2.html#cb8-6" tabindex="-1"></a></span>
<span id="cb8-7"><a href="figure-2.html#cb8-7" tabindex="-1"></a>scAML.sub1 <span class="ot">&lt;-</span> scAML.prog.anno <span class="sc">%&gt;%</span> <span class="fu">subset</span>(FAB <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;M2AE&quot;</span>, <span class="st">&quot;HC_CD34&quot;</span>))</span>
<span id="cb8-8"><a href="figure-2.html#cb8-8" tabindex="-1"></a>scAML.sub1<span class="sc">@</span>meta.data <span class="ot">&lt;-</span> scAML.sub1<span class="sc">@</span>meta.data <span class="sc">%&gt;%</span> </span>
<span id="cb8-9"><a href="figure-2.html#cb8-9" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">annoL2 =</span> <span class="fu">as.character</span>(annoL2), </span>
<span id="cb8-10"><a href="figure-2.html#cb8-10" tabindex="-1"></a>           <span class="at">annoL2 =</span> <span class="fu">ifelse</span>(FAB <span class="sc">%in%</span> <span class="st">&quot;HC_CD34&quot;</span>, <span class="st">&quot;HC_CD34&quot;</span>, annoL2),</span>
<span id="cb8-11"><a href="figure-2.html#cb8-11" tabindex="-1"></a>           <span class="at">annoL2 =</span> <span class="fu">factor</span>(annoL2, <span class="at">levels =</span> <span class="fu">names</span>(anno_color2)[<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">3</span>, <span class="dv">6</span><span class="sc">:</span><span class="dv">7</span>, <span class="dv">10</span><span class="sc">:</span><span class="dv">12</span>, <span class="dv">9</span>, <span class="dv">8</span>)]))</span>
<span id="cb8-12"><a href="figure-2.html#cb8-12" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">DimPlot</span>(scAML.sub1, <span class="at">reduction =</span> <span class="st">&quot;umap&quot;</span>, <span class="at">group.by =</span> <span class="st">&quot;annoL2&quot;</span>, <span class="at">cols =</span> anno_color2,</span>
<span id="cb8-13"><a href="figure-2.html#cb8-13" tabindex="-1"></a>        <span class="at">order =</span> T, <span class="at">label =</span> F, <span class="at">repel =</span> T, <span class="at">raster =</span> T, <span class="at">pt.size =</span> <span class="fl">0.5</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;M2&quot;</span>)</span>
<span id="cb8-14"><a href="figure-2.html#cb8-14" tabindex="-1"></a></span>
<span id="cb8-15"><a href="figure-2.html#cb8-15" tabindex="-1"></a>scAML.sub2 <span class="ot">&lt;-</span> scAML.prog.anno <span class="sc">%&gt;%</span> <span class="fu">subset</span>(FAB <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;M3PR&quot;</span>, <span class="st">&quot;HC_CD34&quot;</span>))</span>
<span id="cb8-16"><a href="figure-2.html#cb8-16" tabindex="-1"></a>scAML.sub2<span class="sc">@</span>meta.data <span class="ot">&lt;-</span> scAML.sub2<span class="sc">@</span>meta.data <span class="sc">%&gt;%</span> </span>
<span id="cb8-17"><a href="figure-2.html#cb8-17" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">annoL2 =</span> <span class="fu">as.character</span>(annoL2), </span>
<span id="cb8-18"><a href="figure-2.html#cb8-18" tabindex="-1"></a>           <span class="at">annoL2 =</span> <span class="fu">ifelse</span>(FAB <span class="sc">%in%</span> <span class="st">&quot;HC_CD34&quot;</span>, <span class="st">&quot;HC_CD34&quot;</span>, annoL2),</span>
<span id="cb8-19"><a href="figure-2.html#cb8-19" tabindex="-1"></a>           <span class="at">annoL2 =</span> <span class="fu">factor</span>(annoL2, <span class="at">levels =</span> <span class="fu">names</span>(anno_color2)[<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span><span class="sc">:</span><span class="dv">12</span>, <span class="dv">5</span>, <span class="dv">3</span>)]))</span>
<span id="cb8-20"><a href="figure-2.html#cb8-20" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">DimPlot</span>(scAML.sub2, <span class="at">reduction =</span> <span class="st">&quot;umap&quot;</span>, <span class="at">group.by =</span> <span class="st">&quot;annoL2&quot;</span>, <span class="at">cols =</span> anno_color2,</span>
<span id="cb8-21"><a href="figure-2.html#cb8-21" tabindex="-1"></a>        <span class="at">order =</span> T, <span class="at">label =</span> F, <span class="at">repel =</span> T, <span class="at">raster =</span> T, <span class="at">pt.size =</span> <span class="fl">0.5</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;M3&quot;</span>)</span>
<span id="cb8-22"><a href="figure-2.html#cb8-22" tabindex="-1"></a></span>
<span id="cb8-23"><a href="figure-2.html#cb8-23" tabindex="-1"></a>scAML.sub3 <span class="ot">&lt;-</span> scAML.prog.anno <span class="sc">%&gt;%</span> <span class="fu">subset</span>(FAB <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;M4CM&quot;</span>, <span class="st">&quot;HC_CD34&quot;</span>))</span>
<span id="cb8-24"><a href="figure-2.html#cb8-24" tabindex="-1"></a>scAML.sub3<span class="sc">@</span>meta.data <span class="ot">&lt;-</span> scAML.sub3<span class="sc">@</span>meta.data <span class="sc">%&gt;%</span> </span>
<span id="cb8-25"><a href="figure-2.html#cb8-25" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">annoL2 =</span> <span class="fu">as.character</span>(annoL2), </span>
<span id="cb8-26"><a href="figure-2.html#cb8-26" tabindex="-1"></a>           <span class="at">annoL2 =</span> <span class="fu">ifelse</span>(FAB <span class="sc">%in%</span> <span class="st">&quot;HC_CD34&quot;</span>, <span class="st">&quot;HC_CD34&quot;</span>, annoL2),</span>
<span id="cb8-27"><a href="figure-2.html#cb8-27" tabindex="-1"></a>           <span class="at">annoL2 =</span> <span class="fu">factor</span>(annoL2, <span class="at">levels =</span> <span class="fu">names</span>(anno_color2)[<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="dv">4</span><span class="sc">:</span><span class="dv">7</span>, <span class="dv">10</span><span class="sc">:</span><span class="dv">12</span>, <span class="dv">3</span>, <span class="dv">8</span><span class="sc">:</span><span class="dv">9</span>)]))</span>
<span id="cb8-28"><a href="figure-2.html#cb8-28" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">DimPlot</span>(scAML.sub3, <span class="at">reduction =</span> <span class="st">&quot;umap&quot;</span>, <span class="at">group.by =</span> <span class="st">&quot;annoL2&quot;</span>, <span class="at">cols =</span> anno_color2,</span>
<span id="cb8-29"><a href="figure-2.html#cb8-29" tabindex="-1"></a>        <span class="at">order =</span> T, <span class="at">label =</span> F, <span class="at">repel =</span> T, <span class="at">raster =</span> T, <span class="at">pt.size =</span> <span class="fl">0.5</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;M4&quot;</span>)</span>
<span id="cb8-30"><a href="figure-2.html#cb8-30" tabindex="-1"></a></span>
<span id="cb8-31"><a href="figure-2.html#cb8-31" tabindex="-1"></a></span>
<span id="cb8-32"><a href="figure-2.html#cb8-32" tabindex="-1"></a><span class="fu">pdf</span>(<span class="fu">paste0</span>(out_dir, <span class="st">&quot;Fig2c.pdf&quot;</span>), <span class="at">width =</span> <span class="dv">13</span>, <span class="at">height =</span> <span class="dv">4</span>)</span>
<span id="cb8-33"><a href="figure-2.html#cb8-33" tabindex="-1"></a>p1 <span class="sc">+</span> p2 <span class="sc">+</span> p3 <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">guides =</span> <span class="st">&quot;collect&quot;</span>)</span>
<span id="cb8-34"><a href="figure-2.html#cb8-34" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
</div>
<div id="d-bar-charts-1" class="section level2 hasAnchor" number="2.3">
<h2><span class="header-section-number">2.3</span> (d) Bar charts<a href="figure-2.html#d-bar-charts-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="figure-2.html#cb9-1" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">plot_stat</span>(scAML.prog.anno, <span class="at">plot_type =</span> <span class="st">&quot;prop_fill&quot;</span>, <span class="at">group_by =</span> <span class="st">&quot;FAB&quot;</span>, <span class="at">pal_setup =</span> anno_color) <span class="sc">+</span> </span>
<span id="cb9-2"><a href="figure-2.html#cb9-2" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>))</span>
<span id="cb9-3"><a href="figure-2.html#cb9-3" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">plot_stat</span>(scAML.prog.anno, <span class="at">plot_type =</span> <span class="st">&quot;prop_fill&quot;</span>, <span class="at">group_by =</span> <span class="st">&quot;orig.ident&quot;</span>, <span class="at">pal_setup =</span> anno_color) <span class="sc">+</span> </span>
<span id="cb9-4"><a href="figure-2.html#cb9-4" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>))</span>
<span id="cb9-5"><a href="figure-2.html#cb9-5" tabindex="-1"></a></span>
<span id="cb9-6"><a href="figure-2.html#cb9-6" tabindex="-1"></a><span class="fu">pdf</span>(<span class="fu">paste0</span>(out_dir, <span class="st">&quot;Fig2d.pdf&quot;</span>), <span class="at">width =</span> <span class="dv">9</span>,  <span class="at">height =</span> <span class="dv">4</span>)</span>
<span id="cb9-7"><a href="figure-2.html#cb9-7" tabindex="-1"></a>p1 <span class="sc">+</span> p2 <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">widths =</span> <span class="fu">c</span>(<span class="fl">0.45</span>, <span class="dv">3</span>), <span class="at">guides =</span> <span class="st">&quot;collect&quot;</span>)</span>
<span id="cb9-8"><a href="figure-2.html#cb9-8" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
</div>
<div id="e-fusion-distribution" class="section level2 hasAnchor" number="2.4">
<h2><span class="header-section-number">2.4</span> (e) Fusion distribution<a href="figure-2.html#e-fusion-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="figure-2.html#cb10-1" tabindex="-1"></a>df <span class="ot">&lt;-</span> scAML.prog.anno<span class="sc">@</span>meta.data <span class="sc">%&gt;%</span></span>
<span id="cb10-2"><a href="figure-2.html#cb10-2" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">fus_group2 =</span> <span class="fu">case_when</span>(</span>
<span id="cb10-3"><a href="figure-2.html#cb10-3" tabindex="-1"></a>            (fus_group <span class="sc">==</span> <span class="st">&quot;Positive&quot;</span> <span class="sc">&amp;</span> FAB <span class="sc">==</span> <span class="st">&quot;M2AE&quot;</span>) <span class="sc">~</span> <span class="st">&quot;M2AE&quot;</span>,</span>
<span id="cb10-4"><a href="figure-2.html#cb10-4" tabindex="-1"></a>            (fus_group <span class="sc">==</span> <span class="st">&quot;Positive&quot;</span> <span class="sc">&amp;</span> FAB <span class="sc">==</span> <span class="st">&quot;M3PR&quot;</span>) <span class="sc">~</span> <span class="st">&quot;M3PR&quot;</span>,</span>
<span id="cb10-5"><a href="figure-2.html#cb10-5" tabindex="-1"></a>            (fus_group <span class="sc">==</span> <span class="st">&quot;Positive&quot;</span> <span class="sc">&amp;</span> FAB <span class="sc">==</span> <span class="st">&quot;M4CM&quot;</span>) <span class="sc">~</span> <span class="st">&quot;M4CM&quot;</span>,</span>
<span id="cb10-6"><a href="figure-2.html#cb10-6" tabindex="-1"></a>            <span class="fu">is.na</span>(fus_group) <span class="sc">~</span> <span class="st">&quot;ANA&quot;</span>)) <span class="sc">%&gt;%</span> <span class="fu">rownames_to_column</span>(<span class="st">&quot;ID&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb10-7"><a href="figure-2.html#cb10-7" tabindex="-1"></a>        <span class="fu">left_join</span>(., scAML.prog.anno<span class="sc">@</span>reductions<span class="sc">$</span>umap<span class="sc">@</span>cell.embeddings <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> <span class="fu">rownames_to_column</span>(<span class="st">&quot;ID&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb10-8"><a href="figure-2.html#cb10-8" tabindex="-1"></a>            <span class="fu">column_to_rownames</span>(<span class="st">&quot;ID&quot;</span>)</span>
<span id="cb10-9"><a href="figure-2.html#cb10-9" tabindex="-1"></a></span>
<span id="cb10-10"><a href="figure-2.html#cb10-10" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">is.na</span>(fus_group))</span>
<span id="cb10-11"><a href="figure-2.html#cb10-11" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(fus_group)) <span class="sc">%&gt;%</span> <span class="fu">sample_n</span>(<span class="fu">nrow</span>(.))</span>
<span id="cb10-12"><a href="figure-2.html#cb10-12" tabindex="-1"></a><span class="fu">pdf</span>(<span class="fu">paste0</span>(out_dir, <span class="st">&quot;Fig2e.pdf&quot;</span>), <span class="at">width =</span> <span class="fl">4.7</span>, <span class="at">height =</span> <span class="fl">3.5</span>)</span>
<span id="cb10-13"><a href="figure-2.html#cb10-13" tabindex="-1"></a><span class="fu">rbind</span>(df1, df2) <span class="sc">%&gt;%</span> </span>
<span id="cb10-14"><a href="figure-2.html#cb10-14" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">mysize =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(fus_group), <span class="dv">1</span>, <span class="dv">3</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb10-15"><a href="figure-2.html#cb10-15" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb10-16"><a href="figure-2.html#cb10-16" tabindex="-1"></a>  ggrastr<span class="sc">::</span><span class="fu">rasterise</span>(<span class="fu">geom_point</span>(<span class="fu">aes_string</span>(<span class="at">x =</span> <span class="st">&quot;umap_1&quot;</span>, <span class="at">y =</span> <span class="st">&quot;umap_2&quot;</span>, <span class="at">color =</span> <span class="st">&quot;fus_group2&quot;</span>, <span class="at">size =</span> <span class="st">&quot;mysize&quot;</span>), </span>
<span id="cb10-17"><a href="figure-2.html#cb10-17" tabindex="-1"></a>        <span class="at">stroke =</span> <span class="dv">0</span>, <span class="at">alpha =</span> <span class="dv">1</span>), <span class="at">dpi =</span> <span class="dv">300</span>) <span class="sc">+</span> </span>
<span id="cb10-18"><a href="figure-2.html#cb10-18" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;#D9D9D9&quot;</span>, <span class="st">&quot;#F8766D&quot;</span>, <span class="st">&quot;#00BA38&quot;</span>, <span class="st">&quot;#619CFF&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb10-19"><a href="figure-2.html#cb10-19" tabindex="-1"></a>  <span class="fu">scale_size_continuous</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.3</span>)) <span class="sc">+</span> </span>
<span id="cb10-20"><a href="figure-2.html#cb10-20" tabindex="-1"></a>  ggthemes<span class="sc">::</span><span class="fu">theme_few</span>()</span>
<span id="cb10-21"><a href="figure-2.html#cb10-21" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
</div>
<div id="f-pseudotime-umap" class="section level2 hasAnchor" number="2.5">
<h2><span class="header-section-number">2.5</span> (f) Pseudotime UMAP<a href="figure-2.html#f-pseudotime-umap" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="figure-2.html#cb11-1" tabindex="-1"></a>cds <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="fu">paste0</span>(in_dir, <span class="st">&quot;Table1.4.scAML.prog_harmony.anno.monocle3.rds&quot;</span>))</span>
<span id="cb11-2"><a href="figure-2.html#cb11-2" tabindex="-1"></a></span>
<span id="cb11-3"><a href="figure-2.html#cb11-3" tabindex="-1"></a>scAML.prog.anno <span class="ot">&lt;-</span> <span class="fu">AddMetaData</span>(<span class="at">object =</span> scAML.prog.anno, </span>
<span id="cb11-4"><a href="figure-2.html#cb11-4" tabindex="-1"></a>    <span class="at">metadata =</span> cds<span class="sc">@</span>principal_graph_aux<span class="sc">@</span>listData<span class="sc">$</span>UMAP<span class="sc">$</span>pseudotime, <span class="at">col.name =</span> <span class="st">&quot;pseudotime&quot;</span>)</span>
<span id="cb11-5"><a href="figure-2.html#cb11-5" tabindex="-1"></a></span>
<span id="cb11-6"><a href="figure-2.html#cb11-6" tabindex="-1"></a><span class="fu">pdf</span>(<span class="fu">paste0</span>(out_dir, <span class="st">&quot;Fig2f.pdf&quot;</span>), <span class="at">width =</span> <span class="dv">4</span>, <span class="at">height =</span> <span class="fl">3.5</span>)</span>
<span id="cb11-7"><a href="figure-2.html#cb11-7" tabindex="-1"></a><span class="fu">FeaturePlot</span>(scAML.prog.anno, <span class="at">features =</span> <span class="st">&quot;pseudotime&quot;</span>, <span class="at">pt.size =</span> <span class="fl">0.4</span>, <span class="at">order =</span> T, <span class="at">reduction =</span> <span class="st">&quot;umap&quot;</span>, <span class="at">raster =</span> T)  <span class="sc">&amp;</span> </span>
<span id="cb11-8"><a href="figure-2.html#cb11-8" tabindex="-1"></a>            <span class="fu">scale_color_viridis_c</span>()</span>
<span id="cb11-9"><a href="figure-2.html#cb11-9" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
</div>
<div id="g-ridge-plot-of-pseudotime" class="section level2 hasAnchor" number="2.6">
<h2><span class="header-section-number">2.6</span> (g) Ridge plot of pseudotime<a href="figure-2.html#g-ridge-plot-of-pseudotime" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="figure-2.html#cb12-1" tabindex="-1"></a>df <span class="ot">&lt;-</span> scAML.prog.anno<span class="sc">@</span>meta.data <span class="sc">%&gt;%</span> <span class="fu">rownames_to_column</span>(<span class="st">&quot;ID&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb12-2"><a href="figure-2.html#cb12-2" tabindex="-1"></a>        <span class="fu">left_join</span>(., scAML.prog.anno<span class="sc">@</span>reductions<span class="sc">$</span>umap<span class="sc">@</span>cell.embeddings <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> <span class="fu">rownames_to_column</span>(<span class="st">&quot;ID&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb12-3"><a href="figure-2.html#cb12-3" tabindex="-1"></a>        <span class="fu">column_to_rownames</span>(<span class="st">&quot;ID&quot;</span>)</span>
<span id="cb12-4"><a href="figure-2.html#cb12-4" tabindex="-1"></a></span>
<span id="cb12-5"><a href="figure-2.html#cb12-5" tabindex="-1"></a><span class="fu">pdf</span>(<span class="fu">paste0</span>(out_dir, <span class="st">&quot;Fig2g.pdf&quot;</span>), <span class="at">width =</span> <span class="dv">6</span>, <span class="at">height =</span> <span class="dv">4</span>, <span class="at">useDingbats =</span> F)</span>
<span id="cb12-6"><a href="figure-2.html#cb12-6" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> pseudotime, <span class="at">y =</span> annoL2, <span class="at">fill =</span> <span class="fu">stat</span>(x))) <span class="sc">+</span></span>
<span id="cb12-7"><a href="figure-2.html#cb12-7" tabindex="-1"></a>  ggridges<span class="sc">::</span><span class="fu">geom_density_ridges_gradient</span>(<span class="at">scale =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb12-8"><a href="figure-2.html#cb12-8" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="at">name=</span><span class="st">&quot;Pseudotime&quot;</span>, <span class="at">colors =</span> <span class="fu">colorRampPalette</span>(<span class="fu">rev</span>(<span class="fu">brewer.pal</span>(<span class="dv">10</span>, <span class="st">&quot;Spectral&quot;</span>)))(<span class="dv">99</span>)) <span class="sc">+</span></span>
<span id="cb12-9"><a href="figure-2.html#cb12-9" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="at">limits =</span> rev) <span class="sc">+</span> <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb12-10"><a href="figure-2.html#cb12-10" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span>
<span id="cb12-11"><a href="figure-2.html#cb12-11" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
</div>
<div id="h-dot-plots-of-signature-scores" class="section level2 hasAnchor" number="2.7">
<h2><span class="header-section-number">2.7</span> (h) Dot plots of signature scores<a href="figure-2.html#h-dot-plots-of-signature-scores" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="figure-2.html#cb13-1" tabindex="-1"></a>idx_feature <span class="ot">=</span> <span class="fu">rev</span>(<span class="fu">colnames</span>(scAML.prog.anno<span class="sc">@</span>meta.data)[<span class="fu">c</span>(<span class="dv">25</span><span class="sc">:</span><span class="dv">37</span>, <span class="dv">40</span><span class="sc">:</span><span class="dv">58</span>)])</span>
<span id="cb13-2"><a href="figure-2.html#cb13-2" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">DotPlot</span>(<span class="at">object =</span> scAML.prog.anno, <span class="at">assay =</span> <span class="st">&quot;RNA&quot;</span>, <span class="at">features =</span> idx_feature, <span class="at">cols =</span> <span class="st">&quot;RdYlBu&quot;</span>, </span>
<span id="cb13-3"><a href="figure-2.html#cb13-3" tabindex="-1"></a>        <span class="at">group.by =</span> <span class="st">&quot;FAB&quot;</span>, <span class="at">split.by =</span> <span class="st">&quot;annoL2&quot;</span>) <span class="sc">+</span> </span>
<span id="cb13-4"><a href="figure-2.html#cb13-4" tabindex="-1"></a>        <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">size =</span> pct.exp), <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">stroke =</span> <span class="fl">0.2</span>) <span class="sc">+</span> </span>
<span id="cb13-5"><a href="figure-2.html#cb13-5" tabindex="-1"></a>        <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span> <span class="fu">coord_flip</span>()</span>
<span id="cb13-6"><a href="figure-2.html#cb13-6" tabindex="-1"></a></span>
<span id="cb13-7"><a href="figure-2.html#cb13-7" tabindex="-1"></a><span class="do">####</span></span>
<span id="cb13-8"><a href="figure-2.html#cb13-8" tabindex="-1"></a>anno_name <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;HSC.MPP-like&quot;</span>, <span class="st">&quot;LMPP-like&quot;</span>, <span class="st">&quot;CLP-like&quot;</span>, <span class="st">&quot;GMP-like&quot;</span>, <span class="st">&quot;BaEoMa-like&quot;</span>, <span class="st">&quot;Progs-Prolif&quot;</span>, <span class="st">&quot;NPW-high&quot;</span>, <span class="st">&quot;LSC17-high&quot;</span>, <span class="st">&quot;Pre-DC&quot;</span>, <span class="st">&quot;Erythroid&quot;</span>, <span class="st">&quot;Pre-B&quot;</span>)</span>
<span id="cb13-9"><a href="figure-2.html#cb13-9" tabindex="-1"></a>df_raw <span class="ot">&lt;-</span> p<span class="sc">$</span>data <span class="sc">%&gt;%</span> </span>
<span id="cb13-10"><a href="figure-2.html#cb13-10" tabindex="-1"></a>                <span class="fu">mutate</span>(<span class="at">FAB =</span> <span class="fu">str_extract</span>(id, <span class="st">&quot;M2AE|M3PR|M4CM|HC_CD34&quot;</span>), </span>
<span id="cb13-11"><a href="figure-2.html#cb13-11" tabindex="-1"></a>                       <span class="at">annoL2 =</span> <span class="fu">str_replace_all</span>(id, <span class="st">&quot;M2AE_|M3PR_|M4CM_|HC_CD34_&quot;</span>, <span class="st">&quot;&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb13-12"><a href="figure-2.html#cb13-12" tabindex="-1"></a>                <span class="fu">mutate</span>(<span class="at">FAB =</span> <span class="fu">factor</span>(FAB, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;M2AE&quot;</span>, <span class="st">&quot;M3PR&quot;</span>, <span class="st">&quot;M4CM&quot;</span>, <span class="st">&quot;HC_CD34&quot;</span>)),</span>
<span id="cb13-13"><a href="figure-2.html#cb13-13" tabindex="-1"></a>                       <span class="at">annoL2 =</span> <span class="fu">factor</span>(annoL2, <span class="at">levels =</span> anno_name))</span>
<span id="cb13-14"><a href="figure-2.html#cb13-14" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> df_raw <span class="sc">%&gt;%</span> </span>
<span id="cb13-15"><a href="figure-2.html#cb13-15" tabindex="-1"></a>        <span class="fu">group_by</span>(features.plot) <span class="sc">%&gt;%</span> </span>
<span id="cb13-16"><a href="figure-2.html#cb13-16" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">avg.exp.scaled =</span> <span class="fu">MinMax</span>(avg.exp.scaled, <span class="sc">-</span><span class="fl">1.5</span>, <span class="fl">1.5</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb13-17"><a href="figure-2.html#cb13-17" tabindex="-1"></a>    <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb13-18"><a href="figure-2.html#cb13-18" tabindex="-1"></a>        <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> id, <span class="at">y =</span> features.plot, <span class="at">fill =</span> avg.exp.scaled, <span class="at">size =</span> pct.exp), <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">stroke =</span> <span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb13-19"><a href="figure-2.html#cb13-19" tabindex="-1"></a>        <span class="fu">facet_grid</span>(<span class="sc">~</span>FAB, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>, <span class="at">space =</span> <span class="st">&quot;free&quot;</span>) <span class="sc">+</span> </span>
<span id="cb13-20"><a href="figure-2.html#cb13-20" tabindex="-1"></a>        <span class="fu">scale_fill_distiller</span>(<span class="at">palette =</span><span class="st">&quot;RdYlBu&quot;</span>) <span class="sc">+</span> </span>
<span id="cb13-21"><a href="figure-2.html#cb13-21" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span> </span>
<span id="cb13-22"><a href="figure-2.html#cb13-22" tabindex="-1"></a>    <span class="fu">scale_radius</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">6</span>))</span>
<span id="cb13-23"><a href="figure-2.html#cb13-23" tabindex="-1"></a></span>
<span id="cb13-24"><a href="figure-2.html#cb13-24" tabindex="-1"></a><span class="fu">pdf</span>(<span class="fu">paste0</span>(out_dir, <span class="st">&quot;Fig2h.pdf&quot;</span>), <span class="at">width =</span> <span class="dv">12</span>, <span class="at">height =</span> <span class="dv">9</span>)</span>
<span id="cb13-25"><a href="figure-2.html#cb13-25" tabindex="-1"></a>p1</span>
<span id="cb13-26"><a href="figure-2.html#cb13-26" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="figure-3.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
